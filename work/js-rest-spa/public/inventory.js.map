{"version":3,"file":"inventory.js","mappings":"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","sources":["webpack://js-rest-spa/./src/inventory.js"],"sourcesContent":["\"use strict\";\n(function () {\n  let stateInventory = undefined;\n  let stateUser = undefined;\n\n  const MESSAGES = {\n    networkError: \"Trouble connecting to the network.  Please try again\",\n    default: \"Something went wrong.  Please try again\",\n    \"dog-not-allowed-in-username\": \"Dog is not allowed in username\",\n    \"auth-insufficient\": \"Enter a valid username\",\n  };\n\n  checkSession();\n\n  function checkSession() {\n    fetchSession()\n      .then((user) => {\n        stateUser = user.username;\n        fetchInventory()\n          .then((inventory) => {\n            stateInventory = inventory;\n            renderMain();\n          })\n          .catch((error) => {\n            renderStatus(error);\n          });\n      })\n      .catch(() => renderLogin());\n  }\n\n  function addAbilityToLogin() {\n    const buttonEl = document.querySelector(\".login-button\");\n    const usernameEl = document.querySelector(\".login-username\");\n    buttonEl.addEventListener(\"click\", (e) => {\n      const username = usernameEl.value;\n      fetchLogin(username)\n        .then(checkSession)\n        .catch((error) => renderStatus(error));\n    });\n  }\n\n  function addAbilityToLogout() {\n    const buttonEl = document.querySelector(\".logout\");\n    buttonEl.addEventListener(\"click\", (e) => {\n      stateInventory = undefined;\n      fetchLogout()\n        .then(() => {\n          renderLogin();\n        })\n        .catch();\n    });\n  }\n\n  function addAbilityToIncrementInventory() {\n    const buttonEl = document.querySelector(\".button-increment\");\n    buttonEl.addEventListener(\"click\", (e) => {\n      fetchUpdateInventory(stateInventory + 1)\n        .then((inventory) => {\n          stateInventory = inventory;\n          renderMain();\n        })\n        .catch();\n    });\n  }\n\n  function addAbilityToDecrementInventory() {\n    const buttonEl = document.querySelector(\".button-decrement\");\n    buttonEl.addEventListener(\"click\", (e) => {\n      fetchUpdateInventory(stateInventory - 1)\n        .then((inventory) => {\n          stateInventory = inventory;\n          renderMain();\n        })\n        .catch();\n    });\n  }\n\n  function fetchUpdateInventory(inventory) {\n    return fetch(\"/api/inventory\", {\n      method: \"POST\",\n      headers: new Headers({\n        \"content-type\": \"application/json\",\n      }),\n      body: JSON.stringify({ inventory }),\n    })\n      .catch(() => Promise.reject({ error: \"networkError\" }))\n      .then((response) => {\n        if (response.ok) {\n          return response.json();\n        }\n        return response\n          .json()\n          .catch((error) => Promise.reject({ error }))\n          .then((err) => Promise.reject(err));\n      });\n  }\n\n  function fetchInventory() {\n    return fetch(\"/api/inventory\")\n      .catch(() => Promise.reject({ error: \"networkError\" }))\n      .then((response) => {\n        if (response.ok) {\n          return response.json();\n        }\n        return response\n          .json()\n          .catch((error) => Promise.reject({ error }))\n          .then((err) => Promise.reject(err));\n      });\n  }\n\n  function fetchSession() {\n    return fetch(\"/api/session\", {\n      method: \"GET\",\n    })\n      .catch(() => Promise.reject({ error: \"networkError\" }))\n      .then((response) => {\n        if (response.ok) {\n          return response.json();\n        }\n        return response\n          .json()\n          .catch((error) => Promise.reject({ error }))\n          .then((err) => Promise.reject(err));\n      });\n  }\n\n  function fetchLogout() {\n    return fetch(\"/api/session\", {\n      method: \"DELETE\",\n    })\n      .catch(() => Promise.reject({ error: \"networkError\" }))\n      .then((response) => {\n        if (response.ok) {\n          return response.json();\n        }\n        return response\n          .json()\n          .catch((error) => Promise.reject({ error }))\n          .then((err) => Promise.reject(err));\n      });\n  }\n\n  function fetchLogin(username) {\n    return fetch(\"/api/session\", {\n      method: \"POST\",\n      headers: new Headers({\n        \"content-type\": \"application/json\",\n      }),\n      body: JSON.stringify({ username }),\n    })\n      .catch(() => Promise.reject({ error: \"networkError\" }))\n      .then((response) => {\n        if (response.ok) {\n          return;\n        }\n        return response\n          .json()\n          .catch((error) => Promise.reject({ error }))\n          .then((err) => Promise.reject(err));\n      });\n  }\n\n  function renderLogin() {\n    const loginEl = document.querySelector(\".container\");\n    loginEl.innerHTML = `\n      <div class=\"login\">\n        <h1>Login</h1>\n        <input class=\"login-username\" type=\"text\" placeholder=\"username\">\n        <button class=\"login-button\">Login</button>\n        <div class=\"status\"></div>\n      </div>\n    `;\n\n    addAbilityToLogin();\n  }\n\n  function renderMain() {\n    const mainEl = document.querySelector(\".container\");\n    mainEl.innerHTML = `\n      <div class=\"login\">\n      <div class=\"title\">\n        <h3>Welcome ${stateUser}</h3>\n        <button class=\"logout\">Logout</button>\n        </div>\n        <div class=\"inventory\">\n          <button class=\"button-decrement\">-</button>\n          <span class=\"inventory-count\">${stateInventory}</span>\n          <button class=\"button-increment\">+</button>\n        </div>     \n      </div>\n    `;\n    addAbilityToIncrementInventory();\n    addAbilityToDecrementInventory();\n    addAbilityToLogout();\n    const decrementButton = document.querySelector(\".button-decrement\");\n    if (stateInventory <= 0) {\n      decrementButton.disabled = true;\n    } else {\n      decrementButton.disabled = false;\n    }\n  }\n\n  function renderStatus(message) {\n    console.log(message);\n    const statusEl = document.querySelector(\".status\");\n    if (!message) {\n      statusEl.innerText = \"\";\n      return;\n    }\n    const key = message?.error ? message.error : \"default\";\n    statusEl.innerText = MESSAGES[key] || MESSAGES.default;\n  }\n})();\n"],"names":["stateInventory","undefined","stateUser","MESSAGES","networkError","checkSession","fetchSession","then","user","username","fetchInventory","inventory","renderMain","error","renderStatus","renderLogin","addAbilityToLogin","buttonEl","document","querySelector","usernameEl","addEventListener","e","value","fetchLogin","addAbilityToLogout","fetchLogout","addAbilityToIncrementInventory","fetchUpdateInventory","addAbilityToDecrementInventory","fetch","method","headers","Headers","body","JSON","stringify","Promise","reject","response","ok","json","err","loginEl","innerHTML","mainEl","decrementButton","disabled","message","console","log","statusEl","innerText","key"],"sourceRoot":""}